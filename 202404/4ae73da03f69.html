<!DOCTYPE html>
<html lang="zh-CN">


<head>
    <meta charset="UTF-8">
    
    <link rel="apple-touch-icon" sizes="76x76" href="/null">
    <link rel="icon" type="image/png" href="/null">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <title>智博热电管控平台部署 - 因为有你，所以精彩</title>
    
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    
    
    <meta name="description" content="好看的皮囊千篇一律，有趣的灵魂万里挑一">
    <meta name="author" content="nuc_八道门">
    <meta name="keywords" content="">
    <meta property="og:title" content="智博热电管控平台部署"/>
    <style>


    
    :root{
        --shadow-color: rgba(0,0,0,0.2);
        --sec-shadow: rgba(0,0,0,0.03);
        --shadow-hover-color: rgba(0,0,0,0.28);
        --first-text-color: #475b6d;
        --second-text-color: #37475b;
        --third-text-color: #858585;
        --default-text-color: #505050;
        --default-link-color: #007bff;
        --link-color: #000000;
        --second-link-color: #4F9BFA;
        --code-color:rgba(27,31,35,.05);
        --post-bkg-color: #fff;
        --page-bkg-color: #f2f5f8;
        --nav-a-hover-color: #3498db;
        --post-sec-text-color: #718096;
        --sec-bkg: #f2f5f8;
        --color-mode: 'light';
        --bkg-h: rgba(255,255,255,0.6);
        --bkg-m: #e1e4e8;
        --home-title-color: #4169E1;
        --shadow: 0 4px 10px rgba(0,2,4,0.06),0 0 1px rgba(0,2,4,0.11);
        --hr-color: #ddd;
        --bg-t: #f4f4f4;
        --nav-bkg: rgba(255,255,255,0.6);
    }

@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }

  :root:not([data-theme]) {
    --first-text-color: hsla(0,0%,100%,0.92);
    --second-text-color: hsla(0,0%,100%,0.86);
    --third-text-color: #a7a9ad;
    --default-text-color: #505050;
    --default-link-color: #1589e9;
    --link-color: #000000;
    --second-link-color: #30a9de;
    --post-bkg-color: #252d38;
    --page-bkg-color: #181c27;
    --nav-a-hover-color: #3498db;
    --post-sec-text-color: #a7a9ad;
    --sec-bkg: #364151;
    --bkg-h: rgba(255,255,255,0.2);
    --bkg-m: rgba(255,255,255,0.1);
    --home-title-color: rgb(226, 82, 90);
    --code-color:#3e4b5e;
    --shadow: none;
    --hr-color: #718096;
    --bg-t: #364151;
    --nav-bkg: rgba(13,17,23,0.6);
  }
}

[data-theme='dark'] {
    --shadow-color: rgba(0,0,0,0.2);
    --shadow-hover-color: rgba(0,0,0,0.28);
    --first-text-color: hsla(0,0%,100%,0.92);
    --second-text-color: hsla(0,0%,100%,0.86);
    --third-text-color: #a7a9ad;
    --default-text-color: #505050;
    --default-link-color: #1589e9;
    --link-color: #000000;
    --second-link-color: #30a9de;
    --post-bkg-color: #252d38;
    --page-bkg-color: #181c27;
    --nav-a-hover-color: #3498db;
    --post-sec-text-color: #a7a9ad;
    --sec-bkg: #364151;
    --bkg-h: rgba(255,255,255,0.2);
    --bkg-m: rgba(255,255,255,0.1);
    --home-title-color: rgb(226, 82, 90);
    --code-color:#3e4b5e;
    --shadow: none;
    --hr-color: #718096;
    --bg-t: #364151;
    --nav-bkg: rgba(13,17,23,0.6);
}

</style>



    
<link rel="stylesheet" href="/css/custom.css">


<style>
#page-main,footer,.p-btn{
    display: none;
}
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}
body {
    background-color: var(--page-bkg-color);
    color: var(--second-text-color);
    overflow-y: scroll;
    overflow-x: hidden;
    transition: all .3s;
}
a {
    color: var(--default-link-color);
    text-decoration: none;
    background-color: transparent;
}
a:hover{
    color: var(--second-link-color);
}
.main-content,.post-card-main{
    margin: 30px;
}



@media (max-width: 410px){
    .post-card-main{
        max-width: 350px!important;
    }
}

@media (max-width: 980px){
    .post-card-main{
        max-width: 520px!important;
    }
}


@media (min-width: 780px){ 
    h3{
        font-size: 1.5rem;
        line-height: 1.5em;
    }
}
@media (min-width: 1280px){ 
    h3{
        font-size: 1.7rem;
        line-height: 1.5em;
    }
}
@media (min-width: 2096px){ 
    h3{
        font-size: 1.8rem;
        line-height: 1.5em;
    }
}

.text-center{
    text-align: center!important;
}
.middle-center{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    height: 100%;
}
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: fixed;
    height: 54px;
    padding: 0 1.25rem;
    top: 0;
    left: 0;
    right: 0;
    z-index: 10;
    border-bottom: 1px solid var(--bkg-m);
    background-color: var(--nav-bkg);
    backdrop-filter: blur(4px);
    transition: all .3s;
}
header .header__left, header .header__right {
    display: flex;
    align-items: center;
    font-family: rubik,sans-serif,Varela Round;
}
header .header__left .logo__text {
    font-size: 18px;
    font-weight: 450;
    padding: 14.5px 10px;
    border-radius: 5px;
    color: var(--second-text-color);
}
header .header__right .navbar__menus {
    height: 54px;
    padding: 0 0 0 15px;
}
header .header__right .button {
    color: var(--second-text-color);
}
header .header__right .navbar__menus .navbar-menu {
    display: inline-block;
    align-items: center;
    height: 54px;
    padding: 0 10px;
    font-size: 16px;
    line-height: 54px;
}
header .header__right .dropdown-icon {
    display: none;
    height: 54px;
    padding: 15px 10px;
    border: 0;
    background-color: transparent;
}
header .header__right .dropdown-menus {
    line-height: 2rem;
    animation: slide-in .15s ease 1;
    display: none;
    position: absolute;
    left: 12px;
    right: 12px;
    top: calc(54px + 10px);
    border-radius: 6px;
    padding: 24px;
    background-color: var(--page-bkg-color);
    border: 1px solid var(--bkg-m);
    z-index: 9999;
    justify-items: center;
    justify-content: center;
    flex-direction: column;
}
header .header__right #btn-search, header .header__right #btn-toggle-dark{
    display: inline-block;
    padding:  18px 10px;
    height: 25px;
}
header .header__right #btn-dropdown{
  display: inline-block;
  padding:  13.5px 0;
}
header .header__right .dropdown-menus .dropdown-menu {
    padding: 10px;
    color: var(--second-text-color);
}
@media screen and (max-width: 764px){
.navbar__menus {
    display: none!important;
}
.dropdown-icon {
    display: inline-block!important;
}
}
.p-btn{
    position: fixed;
    bottom: 1.2rem;
    right: 1.2rem;
    contain: layout;
}
.toc-btn,.click-btn{
    cursor: pointer;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    align-items: center;
    margin-top: .5rem;
    font-size: .75rem;
    background-color: var(--sec-bkg);
    display: block;
    padding: 0.9rem;
    box-shadow: 0 0.3rem 0.6rem rgba(48,55,66,.15);
    border: none;
    border-radius: 0.5rem;
    line-height: 1;
    color: var(--first-text-color);
}
.toc-link{
    color: var(--second-text-color);
}

#css-loading h3{
    font-weight: 500;
    font-size: 1.4rem;
    text-align: center;
    position: fixed;
    top: 200px;
    left: 0;
    right: 0;
    opacity: 0;
    animation: cssLoad;
    animation-delay: 0.3s;
    -webkit-animation: cssLoad;
    -webkit-animation-delay: 0.3s;
}
@keyframes cssLoad {
    from {
        opacity: 0;
    }
    to {
        opacity: 0.9;
    }
}


.memorial {
    -webkit-filter: grayscale(100%);
    -moz-filter: grayscale(100%);
    -ms-filter: grayscale(100%);
    -o-filter: grayscale(100%);
    filter: grayscale(100%);
    filter:progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); filter:gray;
}


</style>

    

    
        <!--
        <link rel="stylesheet" href="/css/page.css" media="print"
            onload="this.media='all';this.onload=null">
        <noscript>-->
            <link rel="stylesheet" href="/css/page.css">
        <!--</noscript>-->
    
    
    <link rel="stylesheet" href="/css/main.css" media="print" onload="this.media='all';this.onload=null">
    <noscript>
        <link rel="stylesheet" href="/css/main.css">
    </noscript>

    
    <script src="/js/main.js"></script>
    
<meta name="generator" content="Hexo 6.3.0"></head>

    <body>
        <header>
            
<div class="header__left">
	<a href="/" class="button"><span class="logo__text">八一杠</span></a>
</div>
<div class="header__right">
	<div class="navbar__menus">
		
		<a href="/" class="button">
			<div class="navbar-menu">首页</div>
		</a>
		
		<a href="/archives/" class="button">
			<div class="navbar-menu">归档</div>
		</a>
		
		<a href="/categories/" class="button">
			<div class="navbar-menu">分类</div>
		</a>
		
		<a href="/tags/" class="button">
			<div class="navbar-menu">标签</div>
		</a>
		
		<a href="/html" class="button">
			<div class="navbar-menu">模版</div>
		</a>
		
	</div>
	
	<a href="/search/" class="button">
		<div id="btn-search">
			<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1024 1024" width="24" height="24" fill="currentColor"
				stroke="currentColor" stroke-width="32">
				<path
					d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z">
				</path>
			</svg>
		</div>
	</a>
	
	<a href="javaScript:void(0);" class="button" id="btn-toggle-dark">
		<div>
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none"
				stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
				<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
			</svg>
		</div>
	</a>
	<a href="javaScript:void(0);" class="dropdown-icon button">
		<div id="btn-dropdown">
			<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 1024 1024" width="24" height="24" fill="currentColor"
				stroke="currentColor" stroke-width="32" stroke-linecap="round">
				<path
					d="M903.43 561.52H148.8c-13.25 0-24-10.75-24-24s10.75-24 24-24h754.63c13.25 0 24 10.75 24 24s-10.75 24-24 24zM903.43 204.31H148.8c-13.25 0-24-10.75-24-24s10.75-24 24-24h754.63c13.25 0 24 10.75 24 24s-10.75 24-24 24zM903.43 918.73H148.8c-13.25 0-24-10.75-24-24s10.75-24 24-24h754.63c13.25 0 24 10.75 24 24s-10.75 24-24 24z"
					fill="currentColor"></path>
			</svg>
		</div>
	</a>
	<div class="dropdown-menus" id="dropdown-menus">
		
		<a href="/" class="dropdown-menu button">首页</a>
		<br>
		
		<a href="/archives/" class="dropdown-menu button">归档</a>
		<br>
		
		<a href="/categories/" class="dropdown-menu button">分类</a>
		<br>
		
		<a href="/tags/" class="dropdown-menu button">标签</a>
		<br>
		
		<a href="/html" class="dropdown-menu button">模版</a>
		<br>
		
	</div>
</div>

        </header>
        <div id="top"></div>
        <div id="page-main" class="main-content">
        <div class="mg-top">
            

<article class="page">
<div id="post-meta-m">
    <div class="post-meta" id="post-meta">
  <h3>智博热电管控平台部署</h3>
    
      <span class="post-meta-label">
        nuc_八道门
      </span>
    
    
      <span class="post-meta-label">
        <span class="p-dot"></span>
        <time datetime="2024-04-07 00:00" pubdate>
          2024-04-07
        </time>
      </span>
    
    
      
      <span class="post-meta">
        <span class="p-dot"></span>
        共 4.9k 字
      </span>
    
    
      
      <span class="post-meta">
        <span class="p-dot"></span>
        
        预计 
        57
         分钟
      </span>
    
    
      
      <span class="post-meta">
        <span class="p-dot"></span>
        <span id="busuanzi_container_page_pv">
          共 <span id="busuanzi_value_page_pv"></span> 次阅读
        </span>
      </span>
    
  </div>
  
</div>
<div class="article-m">
  <div class="post-toc">
    
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E7%89%88%E6%9C%AC"><span class="toc-number">2.</span> <span class="toc-text">PHP版本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%AA%E9%9D%99%E6%80%81%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">伪静态配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">代码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text">数据库配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81%E5%88%A4%E6%96%AD"><span class="toc-number">4.2.</span> <span class="toc-text">登录密码判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E9%80%BB%E8%BE%91"><span class="toc-number">4.3.</span> <span class="toc-text">密码重置逻辑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%A6%96%E9%A1%B5Controller"><span class="toc-number">4.4.</span> <span class="toc-text">项目首页Controller</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">4.5.</span> <span class="toc-text">路由加载机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A0%B8%E5%BF%83%E6%A1%86%E6%9E%B6%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD"><span class="toc-number">4.5.1.</span> <span class="toc-text">1. 核心框架配置加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%8F%92%E4%BB%B6%E4%B8%8E%E6%A8%A1%E5%9D%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD"><span class="toc-number">4.5.2.</span> <span class="toc-text">2. 插件与模块的配置加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%8E%AF%E5%A2%83%E7%89%B9%E5%AE%9A%E7%9A%84%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD"><span class="toc-number">4.5.3.</span> <span class="toc-text">3. 环境特定的配置加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">4.5.4.</span> <span class="toc-text">4. 服务配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">4.5.5.</span> <span class="toc-text">5. 路由配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%8F%92%E4%BB%B6%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7%E4%B8%8E%E5%8A%A0%E8%BD%BD%E9%A1%BA%E5%BA%8F"><span class="toc-number">4.5.6.</span> <span class="toc-text">6. 插件的优先级与加载顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.5.7.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">4.5.8.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#config-yml-%E8%A7%A3%E6%9E%90"><span class="toc-number">4.6.</span> <span class="toc-text">config.yml 解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-imports"><span class="toc-number">4.6.1.</span> <span class="toc-text">1. imports</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-framework"><span class="toc-number">4.6.2.</span> <span class="toc-text">2. framework</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-bazinga-js-translation"><span class="toc-number">4.6.3.</span> <span class="toc-text">3. bazinga_js_translation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-twig"><span class="toc-number">4.6.4.</span> <span class="toc-text">4. twig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-parameters"><span class="toc-number">4.6.5.</span> <span class="toc-text">5. parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-services"><span class="toc-number">4.6.6.</span> <span class="toc-text">6. services</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93-1"><span class="toc-number">4.7.</span> <span class="toc-text">数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#this-db-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.7.1.</span> <span class="toc-text">$this-&gt;db() 的使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">4.7.2.</span> <span class="toc-text">常用方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.8.</span> <span class="toc-text">模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dump%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.8.1.</span> <span class="toc-text">dump函数的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#path-%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8"><span class="toc-number">4.8.2.</span> <span class="toc-text">path 函数使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%80%81%E6%A1%86%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.8.3.</span> <span class="toc-text">模态框的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%96%E7%BA%BF%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">4.8.4.</span> <span class="toc-text">竖线的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95"><span class="toc-number">4.8.5.</span> <span class="toc-text">自定义方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A"><span class="toc-number">4.8.5.1.</span> <span class="toc-text">第一步：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A"><span class="toc-number">4.8.5.2.</span> <span class="toc-text">第二步：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Twig-%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">4.8.5.2.1.</span> <span class="toc-text">Twig 过滤器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Twig-%E5%87%BD%E6%95%B0"><span class="toc-number">4.8.5.2.2.</span> <span class="toc-text">Twig 函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.8.5.2.3.</span> <span class="toc-text">获取项目服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF"><span class="toc-number">4.8.6.</span> <span class="toc-text">for循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E7%9A%84-for-%E5%BE%AA%E7%8E%AF"><span class="toc-number">4.8.6.1.</span> <span class="toc-text">1. 基本的 for 循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B8%A6%E7%B4%A2%E5%BC%95%E7%9A%84-for-%E5%BE%AA%E7%8E%AF"><span class="toc-number">4.8.6.2.</span> <span class="toc-text">2. 带索引的 for 循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">4.8.6.3.</span> <span class="toc-text">3. 循环中的控制语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-for-%E5%BE%AA%E7%8E%AF%E4%B8%8E%E5%B5%8C%E5%A5%97"><span class="toc-number">4.8.6.4.</span> <span class="toc-text">4. for 循环与嵌套</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%A4%84%E7%90%86%E7%A9%BA%E6%95%B0%E7%BB%84"><span class="toc-number">4.8.6.5.</span> <span class="toc-text">5. 处理空数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-continue-%E5%92%8C-break"><span class="toc-number">4.8.6.6.</span> <span class="toc-text">6. continue 和 break</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-number">4.8.7.</span> <span class="toc-text">获取查询参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-number">4.9.</span> <span class="toc-text">控制器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">4.9.1.</span> <span class="toc-text">重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.9.2.</span> <span class="toc-text">渲染模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Request%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E4%B8%80%E4%B8%AA%E6%8E%A7%E5%88%B6%E5%99%A8%E5%8F%82%E6%95%B0"><span class="toc-number">4.9.3.</span> <span class="toc-text">Request对象作为一个控制器参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">4.9.4.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97"><span class="toc-number">4.10.</span> <span class="toc-text">自定义调试日志</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="toc-number">4.10.1.</span> <span class="toc-text">方案一（推荐）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%BA%8C"><span class="toc-number">4.10.2.</span> <span class="toc-text">方案二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">5.</span> <span class="toc-text">补充</span></a></li></ol>
    
  </div>
    <div id="article">
      <div id="post-content" class="markdown-body textretty">
        <h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><p>数据库版本： MySQL-5.7.26</p>
<p>数据库相关配置</p>
<p>mysql.ini</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br><span class="line"></span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">basedir</span>=D:/phpstudy_pro/Extensions/MySQL5.<span class="number">7.26</span>/</span><br><span class="line"><span class="attr">datadir</span>=D:/phpstudy_pro/Extensions/MySQL5.<span class="number">7.26</span>/data/</span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="attr">default-storage-engine</span>=MyIsam</span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">100</span></span><br><span class="line"><span class="attr">collation-server</span>=utf8_unicode_ci</span><br><span class="line"><span class="attr">init_connect</span>=<span class="string">&#x27;SET NAMES utf8&#x27;</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span>=<span class="number">64</span>M</span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">innodb_lock_wait_timeout</span>=<span class="number">120</span></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span>=<span class="number">4</span>M</span><br><span class="line"><span class="attr">innodb_log_file_size</span>=<span class="number">256</span>M</span><br><span class="line"><span class="attr">interactive_timeout</span>=<span class="number">120</span></span><br><span class="line"><span class="attr">join_buffer_size</span>=<span class="number">2</span>M</span><br><span class="line"><span class="attr">key_buffer_size</span>=<span class="number">32</span>M</span><br><span class="line"><span class="attr">log_error_verbosity</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">max_allowed_packet</span>=<span class="number">16</span>M</span><br><span class="line"><span class="attr">max_heap_table_size</span>=<span class="number">64</span>M</span><br><span class="line"><span class="attr">myisam_max_sort_file_size</span>=<span class="number">64</span>G</span><br><span class="line"><span class="attr">myisam_sort_buffer_size</span>=<span class="number">32</span>M</span><br><span class="line"><span class="attr">read_buffer_size</span>=<span class="number">512</span>kb</span><br><span class="line"><span class="attr">read_rnd_buffer_size</span>=<span class="number">4</span>M</span><br><span class="line"><span class="attr">server_id</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">skip-external-locking</span>=<span class="literal">on</span></span><br><span class="line"><span class="attr">sort_buffer_size</span>=<span class="number">256</span>kb</span><br><span class="line"><span class="attr">table_open_cache</span>=<span class="number">256</span></span><br><span class="line"><span class="attr">thread_cache_size</span>=<span class="number">16</span></span><br><span class="line"><span class="attr">tmp_table_size</span>=<span class="number">64</span>M</span><br><span class="line"><span class="attr">wait_timeout</span>=<span class="number">120</span></span><br><span class="line"><span class="attr">sql_mode</span>= NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION  <span class="comment">#模式配置，不然会报错</span></span><br><span class="line"></span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置完成后，直接导入即可</p>
<h1 id="PHP版本"><a href="#PHP版本" class="headerlink" title="PHP版本"></a>PHP版本</h1><p>下载phpstudy_pro安装，php版本5.6.9nts ,配置网站根目录：cp-zhiboredian-net&#x2F;web</p>
<h1 id="伪静态配置"><a href="#伪静态配置" class="headerlink" title="伪静态配置"></a>伪静态配置</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    if (!-e $request_filename) &#123;</span><br><span class="line">        rewrite /app/(.*)$ /app.php/$1 last;</span><br><span class="line">        rewrite /app_dev/(.*)$ /app_dev.php/$1 last;</span><br><span class="line">        rewrite  ^(.*)$  /app.php?s=$1  last;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><h2 id="数据库配置文件"><a href="#数据库配置文件" class="headerlink" title="数据库配置文件"></a>数据库配置文件</h2><p><strong>cp-zhiboredian-net&#x2F;app&#x2F;config&#x2F;parameters.yml</strong></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">database_host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="attr">database_user:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">database_password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>

<h2 id="登录密码判断"><a href="#登录密码判断" class="headerlink" title="登录密码判断"></a>登录密码判断</h2><p><strong>cp-zhiboredian-net&#x2F;src&#x2F;AppBundle&#x2F;Handler&#x2F;AuthenticationProvider.php</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//58行附近</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">$this</span>-&gt;encoderFactory-&gt;<span class="title function_ invoke__">getEncoder</span>(<span class="variable">$user</span>)-&gt;<span class="title function_ invoke__">isPasswordValid</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">getPassword</span>(), <span class="variable">$presentedPassword</span>, <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">getSalt</span>())) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadCredentialsException</span>(<span class="string">&#x27;The presented password is invalid.&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="密码重置逻辑"><a href="#密码重置逻辑" class="headerlink" title="密码重置逻辑"></a>密码重置逻辑</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//use Symfony\Component\Security\Core\Encoder\MessageDigestPasswordEncoder;</span></span><br><span class="line"><span class="comment">//MessageDigestPasswordEncoder类用来生成密码</span></span><br><span class="line"><span class="variable">$encoder</span> = <span class="keyword">new</span> <span class="title class_">MessageDigestPasswordEncoder</span>(<span class="string">&#x27;sha256&#x27;</span>);</span><br><span class="line"><span class="variable">$raw</span> = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"><span class="variable">$salt</span> = <span class="string">&quot;ny22a724jbkcwggo4s0ccckcwsc8gwg&quot;</span>;</span><br><span class="line"><span class="variable">$encodePassword</span> = <span class="variable">$encoder</span>-&gt;<span class="title function_ invoke__">encodePassword</span>(<span class="variable">$raw</span>, <span class="variable">$salt</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$encodePassword</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解析类MessageDigestPasswordEncoder的功能</span></span><br><span class="line"><span class="variable">$salted</span> = <span class="variable">$raw</span>.<span class="string">&#x27;&#123;&#x27;</span>.<span class="variable">$salt</span>.<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$digest</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$salted</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;stretch&quot; hash</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; <span class="number">5000</span>; ++<span class="variable">$i</span>) &#123;</span><br><span class="line">    <span class="variable">$digest</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$digest</span>.<span class="variable">$salted</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$salt</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$digest</span>);</span><br></pre></td></tr></table></figure>

<h2 id="项目首页Controller"><a href="#项目首页Controller" class="headerlink" title="项目首页Controller"></a>项目首页Controller</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src/CustomBundle/Controller/System/TyjhIndexController.php</span><br></pre></td></tr></table></figure>

<h2 id="路由加载机制"><a href="#路由加载机制" class="headerlink" title="路由加载机制"></a>路由加载机制</h2><p>EduSoho 是基于 Symfony 框架的开源在线教育平台，因此它的配置文件加载顺序在很大程度上继承了 Symfony 框架的机制。不过，EduSoho 本身也有其特定的加载机制和配置文件结构。以下是 EduSoho 中配置文件的加载顺序及机制的概述：</p>
<h3 id="1-核心框架配置加载"><a href="#1-核心框架配置加载" class="headerlink" title="1. 核心框架配置加载"></a>1. <strong>核心框架配置加载</strong></h3><ul>
<li><strong><code>app/config/config.yml</code></strong><ul>
<li>这是 EduSoho 的主配置文件，通常是 Symfony 的 <code>app/config/config.yml</code> 文件。它包含了应用程序的全局配置，如数据库连接、服务、参数等。</li>
<li>此文件会首先加载，并作为所有其他配置的基础。</li>
</ul>
</li>
<li><strong><code>app/config/parameters.yml</code></strong><ul>
<li>包含应用程序中用到的全局参数，如数据库连接的凭据、邮件服务的配置等。<code>parameters.yml</code> 文件通常通过安装时的参数定义生成。</li>
<li>这个文件也在早期阶段加载，以便在其他配置文件中使用参数。</li>
</ul>
</li>
</ul>
<h3 id="2-插件与模块的配置加载"><a href="#2-插件与模块的配置加载" class="headerlink" title="2. 插件与模块的配置加载"></a>2. <strong>插件与模块的配置加载</strong></h3><ul>
<li><strong><code>src/</code> 目录中的模块</strong><ul>
<li>EduSoho 中的插件和模块通常位于 <code>src/</code> 目录下。每个插件或模块可能都有自己的配置文件，通常位于模块目录下的 <code>Resources/config/</code> 中。</li>
<li>这些配置文件会在 <code>app/config/config.yml</code> 加载之后，根据模块的定义顺序依次加载。</li>
</ul>
</li>
<li><strong><code>src/</code> 目录中的插件的路由配置</strong><ul>
<li>各插件的路由配置文件通常位于 <code>src/PluginName/Resources/config/routing.yml</code> 或 <code>routing.php</code> 中。它们的加载顺序依据插件的初始化顺序决定，通常在核心应用的路由加载之后。</li>
</ul>
</li>
</ul>
<h3 id="3-环境特定的配置加载"><a href="#3-环境特定的配置加载" class="headerlink" title="3. 环境特定的配置加载"></a>3. <strong>环境特定的配置加载</strong></h3><ul>
<li><code>app/config/config_&#123;environment&#125;.yml</code><ul>
<li>与 Symfony 类似，EduSoho 也支持环境特定的配置。例如，<code>config_dev.yml</code> 用于开发环境，<code>config_prod.yml</code> 用于生产环境。</li>
<li>这些文件会在全局配置加载后加载，并覆盖全局配置中的相关设置。</li>
</ul>
</li>
</ul>
<h3 id="4-服务配置"><a href="#4-服务配置" class="headerlink" title="4. 服务配置"></a>4. <strong>服务配置</strong></h3><ul>
<li><code>services.yml</code> 与 <code>services_&#123;environment&#125;.yml</code><ul>
<li>类似于 Symfony，EduSoho 中的服务配置文件也会在配置加载的较晚阶段被加载。这些文件用于定义和配置服务容器中的服务，通常位于 <code>app/config/services.yml</code> 中。</li>
<li>环境特定的服务配置文件（如 <code>services_dev.yml</code>）会覆盖默认的服务配置。</li>
</ul>
</li>
</ul>
<h3 id="5-路由配置"><a href="#5-路由配置" class="headerlink" title="5. 路由配置"></a>5. <strong>路由配置</strong></h3><ul>
<li><code>app/config/routing.yml</code><ul>
<li>EduSoho 使用 Symfony 的路由配置机制。<code>routing.yml</code> 文件通常是核心应用路由的入口点。所有插件和模块的路由会被合并到主路由配置中。</li>
<li>路由配置文件通常在所有服务和配置加载之后加载，以确保路由可以依赖其他已加载的服务。</li>
</ul>
</li>
</ul>
<h3 id="6-插件的优先级与加载顺序"><a href="#6-插件的优先级与加载顺序" class="headerlink" title="6. 插件的优先级与加载顺序"></a>6. <strong>插件的优先级与加载顺序</strong></h3><ul>
<li>插件的加载顺序通常由 <code>AppKernel.php</code> 文件中的 <code>registerBundles()</code> 方法定义。如果需要控制插件的加载顺序，可以在这里调整。</li>
<li>插件中的配置会覆盖之前加载的核心配置，确保插件能够根据需要自定义和扩展平台功能。</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><strong>全局配置文件</strong> (<code>config.yml</code>, <code>parameters.yml</code>) 最早加载，提供应用程序的基础配置。</li>
<li><strong>插件与模块配置</strong> 依次加载，允许自定义和扩展平台功能。</li>
<li><strong>环境特定配置</strong> 在全局配置之后加载，并根据运行环境进行配置覆盖。</li>
<li><strong>服务和路由配置</strong> 在所有其他配置加载完成后加载，确保可以依赖所有已加载的服务和配置。</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">crm_contract:</span></span><br><span class="line">    <span class="attr">path:</span>     <span class="string">/crm/contract</span></span><br><span class="line">    <span class="attr">defaults:</span> &#123; <span class="attr">_controller:</span> <span class="string">CustomBundle:Crm/Contract:list</span> &#125;</span><br></pre></td></tr></table></figure>

<p>这个路由配置段落定义了一个名为 <code>crm_contract</code> 的路由，它包含了路径、默认控制器及方法的设定。下面是对每个配置项的详细解释：</p>
<ol>
<li><strong>路由名称：<code>crm_contract</code></strong></li>
</ol>
<ul>
<li><strong>定义</strong>: <code>crm_contract</code> 是该路由的唯一标识符。在应用程序的其他地方可以通过这个名称来引用该路由，例如在生成 URL 时。</li>
<li><strong>作用</strong>: 路由名称在配置文件中是唯一的，用来区分不同的路由。</li>
</ul>
<ol start="2">
<li><strong><code>path: /crm/contract</code></strong></li>
</ol>
<ul>
<li><strong>定义</strong>: <code>path</code> 指定了这个路由的 URL 路径为 <code>/crm/contract</code>。</li>
<li><strong>作用</strong>: 当用户在浏览器中访问 <code>http://yourdomain.com/crm/contract</code> 时，该路径会触发对应的控制器操作。这个路径是用户访问应用程序时看到的 URL 部分。</li>
</ul>
<ol start="3">
<li><strong><code>defaults: &#123; _controller: CustomBundle:Crm/Contract:list &#125;</code></strong></li>
</ol>
<ul>
<li><strong>定义</strong>: <code>defaults</code> 配置中定义了该路由的默认控制器及方法。在这里，<code>_controller</code> 是 Symfony 的特殊参数，用来指定处理该路由的控制器和方法。</li>
<li>具体解释:<ul>
<li><code>CustomBundle</code>: 指定了该控制器所在的 bundle，通常是应用程序中的一个模块或功能包。</li>
<li><code>Crm/Contract</code>: 指定了控制器的名称。在 Symfony 中，控制器通常以 <code>Controller</code> 作为后缀，实际上这里指定的是 <code>Crm/ContractController</code>。</li>
<li><code>list</code>: 指定了控制器中的一个方法，通常以 <code>Action</code> 作为后缀。这个方法处理用户对 <code>/crm/contract</code> 路径的请求。在这个例子中，实际上调用的可能是 <code>listAction</code> 方法。</li>
</ul>
</li>
<li><strong>作用</strong>: 当用户访问 <code>/crm/contract</code> 路径时，Symfony 会调用 <code>CustomBundle</code> 中的 <code>Crm/ContractController</code> 控制器的 <code>listAction</code> 方法来处理该请求。</li>
</ul>
<p>综合理解</p>
<p>当用户访问 <code>/crm/contract</code> 路径时，Symfony 会查找到名为 <code>crm_contract</code> 的路由，并将请求映射到 <code>CustomBundle</code> 的 <code>Crm/ContractController</code> 控制器的 <code>listAction</code> 方法。这意味着该路径对应的业务逻辑将在这个控制器方法中处理，通常会返回一个视图或执行某种逻辑操作。</p>
<p>例如，这个路由可能用于显示 CRM 合同列表的页面。当访问 <code>http://yourdomain.com/crm/contract</code> 时，<code>listAction</code> 方法会被调用，可能会从数据库中检索合同数据并将其显示在网页上。</p>
<h2 id="config-yml-解析"><a href="#config-yml-解析" class="headerlink" title="config.yml 解析"></a>config.yml 解析</h2><p>这个 <code>config.yml</code> 文件是一个典型的 Symfony 框架配置文件，特别是针对 EduSoho 平台的自定义配置。这个文件定义了框架的各种设置，包括服务、路由、模板引擎、会话管理、资源版本控制等。以下是对每个部分的解析</p>
<h3 id="1-imports"><a href="#1-imports" class="headerlink" title="1. imports"></a>1. <code>imports</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">imports:</span><br><span class="line">    - &#123; resource: per.yml&#125;</span><br><span class="line">    - &#123; resource: tyjh_yht_global.yml&#125;</span><br><span class="line">    - &#123; resource: &quot;@CustomBundle/Resources/config/services.yml&quot; &#125;</span><br></pre></td></tr></table></figure>

<p><code>imports</code> 部分用于引入其他 YAML 配置文件，以便将它们的内容加载到当前配置中。这里引用了三个文件：<code>per.yml</code>、<code>tyjh_yht_global.yml</code> 和 <code>services.yml</code>。其中 <code>@CustomBundle</code> 表示在 <code>CustomBundle</code> 包中的相对路径。</p>
<h3 id="2-framework"><a href="#2-framework" class="headerlink" title="2. framework"></a>2. <code>framework</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">framework:</span><br><span class="line">    translator: &#123; fallback: &quot;%locale%&quot;, logging: false &#125;</span><br><span class="line">    secret: &quot;%secret%&quot;</span><br><span class="line">    router:</span><br><span class="line">        resource: &quot;%kernel.root_dir%/config/routing.yml&quot;</span><br><span class="line">        strict_requirements: ~</span><br><span class="line">    form: ~</span><br><span class="line">    csrf_protection: ~</span><br><span class="line">    validation: &#123; enable_annotations: true &#125;</span><br><span class="line">    templating:</span><br><span class="line">        engines: [&#x27;twig&#x27;]</span><br><span class="line">    default_locale: &quot;%locale%&quot;</span><br><span class="line">    trusted_proxies: ~</span><br><span class="line">    session:</span><br><span class="line">        handler_id: &quot;%session.service_id%&quot;</span><br><span class="line">    fragments: ~</span><br><span class="line">    http_method_override: true</span><br><span class="line">    assets:</span><br><span class="line">        version: &#x27;%app_version%&#x27;</span><br><span class="line">        version_format: &#x27;%%s?version=%%s&#x27;</span><br></pre></td></tr></table></figure>

<p><code>framework</code> 部分配置了 Symfony 框架的核心功能：</p>
<ul>
<li><code>translator</code>: 配置翻译服务，<code>fallback</code> 为默认语言。</li>
<li><code>secret</code>: 用于生成安全令牌等的密钥。</li>
<li><code>router</code>: <font color=red>定义路由配置文件的位置</font>，这里使用了 <code>routing.yml</code>。</li>
<li><code>form</code>, <code>csrf_protection</code>, <code>validation</code>: 控制表单、CSRF 保护和验证功能。</li>
<li><code>templating</code>: 配置模板引擎，这里使用了 <code>twig</code>。</li>
<li><code>session</code>: 配置会话服务的处理器。</li>
<li><code>assets</code>: <font color=red>配置静态资源的版本控制，确保资源更新时浏览器能正确加载新版本。</font></li>
</ul>
<h3 id="3-bazinga-js-translation"><a href="#3-bazinga-js-translation" class="headerlink" title="3. bazinga_js_translation"></a>3. <code>bazinga_js_translation</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bazinga_js_translation:</span><br><span class="line">    locale_fallback: &quot;%locale%&quot;</span><br><span class="line">    default_domain: &quot;js&quot;</span><br></pre></td></tr></table></figure>

<p>配置 <code>bazinga_js_translation</code>，这是一个用于前端 JavaScript 国际化的插件，指定了默认的语言和域。</p>
<h3 id="4-twig"><a href="#4-twig" class="headerlink" title="4. twig"></a>4. <code>twig</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">twig:</span><br><span class="line">    debug: &quot;%kernel.debug%&quot;</span><br><span class="line">    strict_variables: &quot;%kernel.debug%&quot;</span><br><span class="line">    paths:</span><br><span class="line">        &quot;%kernel.root_dir%/../web/customize&quot;: customize</span><br><span class="line">        &quot;%kernel.root_dir%/../src/Topxia/WebBundle/Resources/views&quot;: topxiaweb</span><br><span class="line">        &quot;%kernel.root_dir%/../web/themes&quot;: theme</span><br><span class="line">        &quot;%kernel.root_dir%/../plugins&quot;: plugins</span><br><span class="line">        &quot;%kernel.root_dir%/../&quot; : root</span><br></pre></td></tr></table></figure>

<p><code>twig</code> 部分配置了模板引擎 Twig：</p>
<ul>
<li><code>debug</code> 和 <code>strict_variables</code> 与调试模式相关。</li>
<li><code>paths</code> 定义了模板路径，并为每个路径指定了命名空间。</li>
</ul>
<h3 id="5-parameters"><a href="#5-parameters" class="headerlink" title="5. parameters"></a>5. <code>parameters</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">parameters:</span><br><span class="line">    app.locales: en|zh_CN</span><br><span class="line"></span><br><span class="line">    topxia.disk.local_directory: &quot;%kernel.root_dir%/data/udisk&quot;</span><br><span class="line">    topxia.disk.upgrade_dir: &quot;%kernel.root_dir%/data/upgrade&quot;</span><br><span class="line">    topxia.disk.update_dir: &quot;%kernel.root_dir%/data/upgrade&quot;</span><br><span class="line">    topxia.disk.backup_dir: &quot;%kernel.root_dir%/data/backup&quot;</span><br><span class="line">    topxia.upload.public_directory: &quot;%kernel.root_dir%/../web/files&quot;</span><br><span class="line">    topxia.upload.public_url_path: &quot;/files&quot;</span><br><span class="line">    topxia.upload.private_directory: &quot;%kernel.root_dir%/data/private_files&quot;</span><br><span class="line">    permission.path_regular_expression: [&#x27;/^\/admin/&#x27;]</span><br><span class="line">    router.options.matcher_dumper_class: AppBundle\SfExtend\PhpMatcherDumper</span><br><span class="line">    security.authentication.provider.dao.class: AppBundle\Handler\AuthenticationProvider</span><br></pre></td></tr></table></figure>

<p><code>parameters</code> 定义了一些全局参数：</p>
<ul>
<li><code>app.locales</code> 指定了可用语言。</li>
<li><code>topxia.disk.*</code> 和 <code>topxia.upload.*</code> 配置了文件存储的路径。</li>
<li><code>permission.path_regular_expression</code> 指定了权限路径的正则表达式。</li>
<li><code>router.options.matcher_dumper_class</code> 和 <code>security.authentication.provider.dao.class</code> 是自定义的类，用于扩展路由匹配和认证提供者。</li>
</ul>
<h3 id="6-services"><a href="#6-services" class="headerlink" title="6. services"></a>6. <code>services</code></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">services:</span><br><span class="line">    assets.path_package:</span><br><span class="line">        class: AppBundle\Twig\Asset\PathPackage</span><br><span class="line">        arguments: [&quot;&quot;, &quot;&quot;, &quot;@assets.context&quot;]</span><br><span class="line">    assets.static_version_strategy:</span><br><span class="line">        class: AppBundle\Twig\Asset\VersionStrategy\StaticVersionStrategy</span><br><span class="line">        arguments: [&quot;&quot;, &quot;&quot;, &quot;@biz&quot;]</span><br><span class="line"></span><br><span class="line">    session.handler.pdo:</span><br><span class="line">        class: Codeages\Biz\Framework\Session\Handler\BizSessionHandler</span><br><span class="line">        arguments:</span><br><span class="line">             - &#x27;@biz&#x27;</span><br><span class="line"></span><br><span class="line">    session.handler.redis: &#x27;@session.handler.pdo&#x27;</span><br><span class="line"></span><br><span class="line">    topxia.twig.file_cache:</span><br><span class="line">        class: Biz\Common\FilesystemCache</span><br><span class="line">        arguments:    [&#x27;@service_container&#x27;]</span><br><span class="line"></span><br><span class="line">    topxia.twig.cache_provider:</span><br><span class="line">        class: Asm89\Twig\CacheExtension\CacheProvider\DoctrineCacheAdapter</span><br><span class="line">        arguments:    [&#x27;@topxia.twig.file_cache&#x27;]</span><br><span class="line"></span><br><span class="line">    topxia.twig.cache_strategy:</span><br><span class="line">        class: Biz\Common\LifetimeCacheStrategy</span><br><span class="line">        arguments:    [&#x27;@biz&#x27;, &#x27;@topxia.twig.cache_provider&#x27;]</span><br><span class="line"></span><br><span class="line">    topxia.twig.cache_extension:</span><br><span class="line">        class: Asm89\Twig\CacheExtension\Extension</span><br><span class="line">        arguments:    [&#x27;@topxia.twig.cache_strategy&#x27;]</span><br><span class="line">        tags:</span><br><span class="line">            - &#123; name: twig.extension &#125;</span><br><span class="line"></span><br><span class="line">    ### permission</span><br><span class="line">    permission.admin_voter:</span><br><span class="line">        class: AppBundle\SfExtend\AdminVoter</span><br><span class="line">        tags:</span><br><span class="line">            - &#123; name: security.voter &#125;</span><br><span class="line">        public: false</span><br><span class="line"></span><br><span class="line">    permission.twig.permission_extension:</span><br><span class="line">        class: AppBundle\Twig\PermissionExtension</span><br><span class="line">        arguments:    [&#x27;@service_container&#x27;]</span><br><span class="line">        tags:</span><br><span class="line">            - &#123; name: twig.extension &#125;</span><br><span class="line"></span><br><span class="line">    routing.loader.yml:</span><br><span class="line">        class: AppBundle\SfExtend\YamlFileLoader</span><br><span class="line">        arguments: [&#x27;@file_locator&#x27;]</span><br><span class="line">        tags:</span><br><span class="line">            - &#123;name: routing.loader&#125;</span><br></pre></td></tr></table></figure>

<p><code>services</code> 部分定义了一些服务：</p>
<ul>
<li><code>assets.path_package</code> 和 <code>assets.static_version_strategy</code> 是静态资源处理的服务。</li>
<li><code>session.handler.pdo</code> 和 <code>session.handler.redis</code> 是会话存储处理器。</li>
<li><code>topxia.twig.*</code> 系列是与 Twig 模板缓存相关的服务。</li>
<li><code>permission.admin_voter</code> 和 <code>permission.twig.permission_extension</code> 处理权限验证。</li>
<li><code>routing.loader.yml</code> 是自定义的 YAML 路由加载器。</li>
</ul>
<h2 id="数据库-1"><a href="#数据库-1" class="headerlink" title="数据库"></a>数据库</h2><h3 id="this-db-的使用场景"><a href="#this-db-的使用场景" class="headerlink" title="$this-&gt;db() 的使用场景"></a>$this-&gt;db() 的使用场景</h3><p><code>$this-&gt;db()</code> 是一个用于访问数据库连接的快捷方法，通常在 DAO（数据访问对象）层使用。它返回一个数据库连接实例，允许你直接执行 SQL 查询，而不必通过 Doctrine ORM。这个方法是 EduSoho 框架特有的，方便开发者在需要时直接操作数据库。</p>
<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><p>以下是 <code>$this-&gt;db()</code> 返回的连接对象的一些常用方法：</p>
<ul>
<li><strong><code>fetchAll($sql, $params)</code></strong>: 执行查询并返回所有结果。</li>
<li><strong><code>fetchAssoc($sql, $params)</code></strong>: 执行查询并返回一个关联数组，其中键为第一列的值，值为整行数据。</li>
<li><strong><code>fetchColumn($sql, $params)</code></strong>: 执行查询并返回单个列的值。</li>
<li><strong><code>executeUpdate($sql, $params)</code></strong>: 执行更新查询（如 <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>），返回受影响的行数。</li>
<li><strong><code>beginTransaction()</code></strong>: 开始一个数据库事务。</li>
<li><strong><code>commit()</code></strong>: 提交当前事务。</li>
<li><strong><code>rollBack()</code></strong>: 回滚当前事务。</li>
</ul>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><h3 id="dump函数的使用"><a href="#dump函数的使用" class="headerlink" title="dump函数的使用"></a>dump函数的使用</h3><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; <span class="name">dump</span>(list) &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="comment">&#123;#list是变量名称，dump函数用于调试时使用#&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="path-函数使用"><a href="#path-函数使用" class="headerlink" title="path 函数使用"></a>path 函数使用</h3><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#123;# 表示跳转到 /zb/project/manage/index?project_id=xx 这个地址 #&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;cursor: pointer&quot;</span> <span class="attr">title</span>=<span class="string">&quot;进入&quot;</span> <span class="attr">href</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123; <span class="name">path</span>(<span class="string">&#x27;zb_project_manage_index&#x27;</span>,&#123;project_id:obj.id&#125;) &#125;&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span>&gt;</span>进入<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="comment">&#123;# 通过全局查找相关的路由文件，发现 zb_project_manage_index 定义在src/CustomBundle/Resources/config/zb_routing.yml文件，通过路由文件可找到对应的控制器</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="模态框的使用"><a href="#模态框的使用" class="headerlink" title="模态框的使用"></a>模态框的使用</h3><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">data-url</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123; <span class="name">path</span>(<span class="string">&#x27;zb_my_project_show&#x27;</span>, &#123;project_id: obj.id&#125;) &#125;&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;modal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="attr">data-target</span>=<span class="string">&quot;#modal&quot;</span> <span class="attr">href</span>=<span class="string">&quot;#modal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="attr">title</span>=<span class="string">&quot;项目详情&quot;</span></span></span><span class="comment">&#123;# href=&quot;&#123;&#123; path(&#x27;zb_my_project_show&#x27;,&#123;project_id: obj.id&#125;) &#125;&#125;&quot;#&#125;</span><span class="language-xml"><span class="tag">&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123; obj.project_name &#125;&#125;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="comment">&#123;#</span></span><br><span class="line"><span class="comment">关键参数：</span></span><br><span class="line"><span class="comment">data-url : 定义一个连接地址</span></span><br><span class="line"><span class="comment">data-toggle : </span></span><br><span class="line"><span class="comment">data-target : </span></span><br><span class="line"><span class="comment">#&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="竖线的使用"><a href="#竖线的使用" class="headerlink" title="竖线的使用"></a>竖线的使用</h3><p>竖线表示参数传递</p>
<figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; obj.create_emp_id<span class="punctuation">|</span>get_emp_name &#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义方法"><a href="#自定义方法" class="headerlink" title="自定义方法"></a>自定义方法</h3><p>比如：上个例子中的 get_emp_name 在哪里定义？说到这个问题需要先对app&#x2F;config&#x2F;config.yml的作用有所了解，可参考config.yml解析一节</p>
<h4 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h4><p>在config.yml中自定义一个扩展</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">twig.cus_extension:</span></span><br><span class="line">    <span class="attr">class:</span> <span class="string">CustomBundle\Twig\CusExtension</span></span><br><span class="line">    <span class="attr">arguments:</span> [<span class="string">&#x27;@service_container&#x27;</span>]</span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">name:</span> <span class="string">twig.extension</span> &#125;</span><br></pre></td></tr></table></figure>

<h4 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h4><p>新建一个文件 src&#x2F;CustomBundle&#x2F;Twig&#x2F;CusExtension.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">CustomBundle</span>\<span class="title class_">Twig</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Topxia</span>\<span class="title">Service</span>\<span class="title">Common</span>\<span class="title">ServiceKernel</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CusExtension</span> <span class="keyword">extends</span> \<span class="title">Twig_Extension</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$container</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$builder</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$loader</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$container</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;container = <span class="variable">$container</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Twig 过滤器</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFilters</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">\Twig_SimpleFilter</span>(<span class="string">&#x27;get_com_name&#x27;</span>, <span class="keyword">array</span>(<span class="variable language_">$this</span>, <span class="string">&#x27;getComNameById&#x27;</span>)),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFunctions</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">\Twig_SimpleFunction</span>(<span class="string">&#x27;getProjectName&#x27;</span>, <span class="keyword">array</span>(<span class="variable language_">$this</span>, <span class="string">&#x27;getProjectName&#x27;</span>)),</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getProjectName</span>(<span class="params"><span class="variable">$projectId</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$eduProject</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getEduProjectService</span>()-&gt;<span class="title function_ invoke__">getProjectById</span>(<span class="variable">$projectId</span>);</span><br><span class="line">        <span class="keyword">return</span> !<span class="keyword">empty</span>(<span class="variable">$eduProject</span>[<span class="string">&#x27;name&#x27;</span>])?<span class="variable">$eduProject</span>[<span class="string">&#x27;name&#x27;</span>]:<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getEduProjectService</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">ServiceKernel</span>::<span class="title function_ invoke__">instance</span>()-&gt;<span class="title function_ invoke__">createService</span>(<span class="string">&#x27;CustomBundle:Edu\Project:EduProjectService&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getComNameById</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$id</span>.<span class="string">&quot;abc&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">getComService</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">ServiceKernel</span>::<span class="title function_ invoke__">instance</span>()-&gt;<span class="title function_ invoke__">createService</span>(<span class="string">&#x27;CustomBundle:Bas\Company:CompanyService&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个 PHP 类 <code>CusExtension</code> 是一个自定义的 Twig 扩展类，用于在 Twig 模板中引入自定义的过滤器和函数。它继承自 <code>\Twig_Extension</code>，并使用了 Symfony 服务容器和 <code>ServiceKernel</code> 来获取和调用项目中的服务。以下是对该类的详细解析</p>
<h5 id="Twig-过滤器"><a href="#Twig-过滤器" class="headerlink" title="Twig 过滤器"></a><strong>Twig 过滤器</strong></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">php复制代码<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFilters</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">\Twig_SimpleFilter</span>(<span class="string">&#x27;get_com_name&#x27;</span>, <span class="keyword">array</span>(<span class="variable language_">$this</span>, <span class="string">&#x27;getComNameById&#x27;</span>)),</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>getFilters()</code> 方法</strong>：这个方法定义了一个自定义的 Twig 过滤器 <code>get_com_name</code>。当在 Twig 模板中使用 <code>&#123;&#123; some_variable | get_com_name &#125;&#125;</code> 时，将调用类中的 <code>getComNameById</code> 方法。</li>
</ul>
<h5 id="Twig-函数"><a href="#Twig-函数" class="headerlink" title="Twig 函数"></a><strong>Twig 函数</strong></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFunctions</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">\Twig_SimpleFunction</span>(<span class="string">&#x27;getProjectName&#x27;</span>, <span class="keyword">array</span>(<span class="variable language_">$this</span>, <span class="string">&#x27;getProjectName&#x27;</span>)),</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>getFunctions()</code> 方法</strong>：这个方法定义了一个自定义的 Twig 函数 <code>getProjectName</code>。当在 Twig 模板中使用 <code>&#123;% set name = getProjectName(projectId) %&#125;</code> 时，将调用类中的 <code>getProjectName</code> 方法。</li>
</ul>
<h5 id="获取项目服务"><a href="#获取项目服务" class="headerlink" title="获取项目服务"></a><strong>获取项目服务</strong></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getEduProjectService</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ServiceKernel</span>::<span class="title function_ invoke__">instance</span>()-&gt;<span class="title function_ invoke__">createService</span>(<span class="string">&#x27;CustomBundle:Edu\Project:EduProjectService&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>getEduProjectService()</code> 方法</strong>：该方法通过 <code>ServiceKernel</code> 获取并返回一个名为 <code>EduProjectService</code> 的服务实例，这是一个处理教育项目相关逻辑的服务。</li>
</ul>
<p> <font color=red>注意：当多个扩展类中存在同名方法时，以扩展类在config.yml中定义的顺序为准，优先执行后面定义的</font></p>
<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p>在 Twig 模板中，<code>for</code> 循环用于遍历数组或对象，类似于其他编程语言中的 <code>for</code> 循环。下面是一些常见的用法示例：</p>
<h4 id="1-基本的-for-循环"><a href="#1-基本的-for-循环" class="headerlink" title="1. 基本的 for 循环"></a>1. <strong>基本的 <code>for</code> 循环</strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-variable">&#123;&#123; item &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>解释</strong>：<code>items</code> 是一个数组或对象。循环遍历每个 <code>item</code>，并在模板中显示。</li>
</ul>
<h4 id="2-带索引的-for-循环"><a href="#2-带索引的-for-循环" class="headerlink" title="2. 带索引的 for 循环"></a>2. <strong>带索引的 <code>for</code> 循环</strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> key, item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-variable">&#123;&#123; key &#125;&#125;</span><span class="language-xml">: </span><span class="template-variable">&#123;&#123; item &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>解释</strong>：此例中，<code>key</code> 是数组的索引或对象的键，<code>item</code> 是对应的值。可以在循环中同时使用键和值。</li>
</ul>
<h4 id="3-循环中的控制语句"><a href="#3-循环中的控制语句" class="headerlink" title="3. 循环中的控制语句"></a>3. <strong>循环中的控制语句</strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">if</span> loop.index == <span class="number">1</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">strong</span>&gt;</span>第一个元素<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">endif</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-variable">&#123;&#123; item &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">if</span> loop.last <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">strong</span>&gt;</span>最后一个元素<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">endif</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>解释</p>
<p>loop 是 Twig 提供的一个特殊变量，包含以下属性：</p>
<ul>
<li><code>loop.index</code>：当前循环的索引，从1开始。</li>
<li><code>loop.index0</code>：当前循环的索引，从0开始。</li>
<li><code>loop.revindex</code>：从最后一个开始的索引，从1开始。</li>
<li><code>loop.revindex0</code>：从最后一个开始的索引，从0开始。</li>
<li><code>loop.length</code>：要迭代的项目总数。</li>
<li><code>loop.first</code>：布尔值，当前是否为第一个项目。</li>
<li><code>loop.last</code>：布尔值，当前是否为最后一个项目。</li>
</ul>
</li>
</ul>
<h4 id="4-for-循环与嵌套"><a href="#4-for-循环与嵌套" class="headerlink" title="4. for 循环与嵌套"></a>4. <strong><code>for</code> 循环与嵌套</strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span><span class="template-tag">&#123;%</span> <span class="name">for</span> subitem <span class="keyword">in</span> item.subitems <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><span class="template-variable">&#123;&#123; subitem &#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>解释</strong>：可以嵌套 <code>for</code> 循环来处理多维数组或嵌套结构。</li>
</ul>
<h4 id="5-处理空数组"><a href="#5-处理空数组" class="headerlink" title="5. 处理空数组"></a>5. <strong>处理空数组</strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-variable">&#123;&#123; item &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">else</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>No items found.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>解释</strong>：当 <code>items</code> 为空时，<code>else</code> 块中的内容会被执行。</li>
</ul>
<h4 id="6-continue-和-break"><a href="#6-continue-和-break" class="headerlink" title="6. continue 和 break"></a>6. <strong><code>continue</code> 和 <code>break</code></strong></h4><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">for</span> item <span class="keyword">in</span> items <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">if</span> item == <span class="string">&#x27;skip&#x27;</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        </span><span class="template-tag">&#123;%</span> <span class="name">continue</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">endif</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">if</span> loop.index &gt; <span class="number">5</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        </span><span class="template-tag">&#123;%</span> <span class="name">break</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">endif</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-variable">&#123;&#123; item &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>解释</strong>：<code>continue</code> 跳过当前循环迭代，继续下一次循环；<code>break</code> 结束整个循环。</li>
</ul>
<h3 id="获取查询参数"><a href="#获取查询参数" class="headerlink" title="获取查询参数"></a>获取查询参数</h3><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; <span class="name">dump</span>(app.request.query.get(<span class="string">&quot;xxx&quot;</span>)) &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">name</span>=<span class="string">&quot;project_name&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">value</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;&#123; app.request.query.get(<span class="string">&#x27;project_name&#x27;</span>) &#125;&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;项目名称&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>比如链接地址是：my&#x2F;project?project_name&#x3D;123 ，则xxx就是project_name，那上面的输出：123</p>
<h2 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h2><h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p>如果你想将用户重定向到另一个页面,请使用 <code>redirectToRoute()</code> 方法：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirectToRoute</span>(<span class="string">&#x27;homepage&#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// redirectToRoute is equivalent to using redirect() and generateUrl() together:</span></span><br><span class="line">    <span class="comment">// return $this-&gt;redirect($this-&gt;generateUrl(&#x27;homepage&#x27;));</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认情况下，<code>redirectToRoute()</code>方法执行302（临时）重定向。如果要执行301（永久）重定向，请修改第2个参数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirectToRoute</span>(<span class="string">&#x27;homepage&#x27;</span>, <span class="keyword">array</span>(), <span class="number">301</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从定向到外部网站，使用<code>redirect()</code>并传入外部URL：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;http://symfony.com/doc&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="渲染模板"><a href="#渲染模板" class="headerlink" title="渲染模板"></a>渲染模板</h3><p>如果你使用HTML，你应该想要去渲染一个模板。<code>render()</code>方法可以用来渲染模板并可以把输出的内容放到你的<code>Response</code> 对象：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// renders app/Resources/views/hello/index.html.twig</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">render</span>(<span class="string">&#x27;hello/index.html.twig&#x27;</span>, <span class="keyword">array</span>(<span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$name</span>));</span><br></pre></td></tr></table></figure>

<p>模板也可以放置在更深层次的子目录。但应该避免创建不必要的深层结构：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// renders app/Resources/views/hello/greetings/index.html.twig</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">render</span>(<span class="string">&#x27;hello/greetings/index.html.twig&#x27;</span>, <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$name</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure>

<h3 id="Request对象作为一个控制器参数"><a href="#Request对象作为一个控制器参数" class="headerlink" title="Request对象作为一个控制器参数"></a>Request对象作为一个控制器参数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">   	<span class="variable">$page</span> = <span class="variable">$request</span>-&gt;query-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;page&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">       <span class="variable">$query</span> = <span class="variable">$request</span>-&gt;query-&gt;<span class="title function_ invoke__">all</span>();</span><br><span class="line">    	<span class="variable">$page</span> = <span class="variable">$request</span>-&gt;request-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;page&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="自定义调试日志"><a href="#自定义调试日志" class="headerlink" title="自定义调试日志"></a>自定义调试日志</h2><h3 id="方案一（推荐）"><a href="#方案一（推荐）" class="headerlink" title="方案一（推荐）"></a>方案一（推荐）</h3><p>**Trait **</p>
<p><strong>位置</strong>: <code>src/Common/Traits</code> 或类似的目录</p>
<p><strong>用途</strong>: 如果有一些逻辑在多个类中复用，可以考虑使用 PHP 的 <code>trait</code> 机制。</p>
<p>示例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">AppBundle</span>\<span class="title class_">Common</span>\<span class="title class_">Traits</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Monolog</span>\<span class="title">Handler</span>\<span class="title">StreamHandler</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Monolog</span>\<span class="title">Logger</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Topxia</span>\<span class="title">Service</span>\<span class="title">Common</span>\<span class="title">ServiceKernel</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">LoggerTrait</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$message</span>,<span class="variable">$fileName</span> = <span class="string">&quot;custom&quot;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$fileStream</span> = <span class="title class_">ServiceKernel</span>::<span class="title function_ invoke__">instance</span>()-&gt;<span class="title function_ invoke__">getParameter</span>(<span class="string">&#x27;kernel.logs_dir&#x27;</span>).<span class="string">&#x27;/&#x27;</span>. <span class="variable">$fileName</span> .<span class="string">&#x27;.log&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger = <span class="keyword">new</span> <span class="title class_">\Monolog\Logger</span>(<span class="string">&quot;app&quot;</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">pushHandler</span>(<span class="keyword">new</span> <span class="title class_">StreamHandler</span>(<span class="variable">$fileStream</span>, <span class="title class_">Logger</span>::<span class="variable constant_">DEBUG</span>));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">info</span>(<span class="variable">$message</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在类中使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">AppBundle</span>\<span class="title">Common</span>\<span class="title">Traits</span>\<span class="title">LoggerTrait</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyController</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">LoggerTrait</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">		...</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">log</span>(<span class="number">123</span>);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="方案二"><a href="#方案二" class="headerlink" title="方案二"></a>方案二</h3><p>直接在类里</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyController</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">LoggerTrait</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">indexAction</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">		...</span><br><span class="line">        <span class="variable">$logger</span> = <span class="variable language_">$this</span>-&gt;container-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&quot;logger&quot;</span>);</span><br><span class="line">        <span class="variable">$logger</span>-&gt;<span class="title function_ invoke__">pushHandler</span>(<span class="keyword">new</span> <span class="title class_">StreamHandler</span>(<span class="title class_">ServiceKernel</span>::<span class="title function_ invoke__">instance</span>()-&gt;<span class="title function_ invoke__">getParameter</span>(<span class="string">&#x27;kernel.logs_dir&#x27;</span>).<span class="string">&#x27;/custom.log&#x27;</span>, <span class="title class_">Logger</span>::<span class="variable constant_">DEBUG</span>));</span><br><span class="line">        <span class="variable">$logger</span>-&gt;<span class="title function_ invoke__">info</span>(<span class="number">123</span>);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>默认用户初始密码：123456</p>
<p>打包命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zcvf cp_zhiboredian_net.tar.gz --exclude=vendor --exclude=vendor_user --exclude=app/cache --exclude=web/files --exclude=.git --exclude=.idea --exclude=app/logs cp-zhiboredian-net</span><br></pre></td></tr></table></figure>


      </div>
    </div>
</div>

<div class="post-category">

    <div id="p-meta-i">
        
              
                <a class="hover-with-bg" href="/categories/%E5%B7%A5%E4%BD%9C/">工作</a>
              
                <a class="hover-with-bg" href="/categories/%E5%B7%A5%E4%BD%9C/%E9%83%A8%E7%BD%B2/">部署</a>
              
          
          
              
                <a class="hover-with-bg" href="/tags/%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0/"># 管控平台</a>
              
          
    </div>
</div>


<div class="post-footer">
  

  <div class="post-copyright">
    <p style="margin: 5px 0;">文章作者：<a href="/">nuc_八道门</a></p>
    <p style="margin: 5px 0;">文章链接：<a href="https://shaobingtongzhi.github.io/202404/4ae73da03f69.html">https://shaobingtongzhi.github.io/202404/4ae73da03f69.html</a></p>
    <p style="margin: 5px 0;">版权声明：本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处，谢谢。</p>
  </div>
  
</div>

</article>


        </div>
        
<footer class="text-center">
    
    
    
    
    
    <p>&copy;  2020 - 2023&nbsp;&nbsp;nuc_badaomen</p>
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme by <a href="https://github.com/oCoke/hexo-theme-miracle" target="_blank">Miracle</a></p>
    
    
</footer>

<div class="p-btn">
    
        <a class="toc-btn" id="toc-btn"><i id="i-menu"></i></a>
    
    
      <a class="toc-btn" id="share-btn"><i>
        <svg t="1670124379155" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2683" width="25" height="25"><path d="M395.946667 234.666667v64H256v469.333333h512V522.666667h64V768a64 64 0 0 1-64 64H256a64 64 0 0 1-64-64V298.666667a64 64 0 0 1 64-64h139.946667z m335.850666-87.914667l150.848 150.826667-158.378666 158.4-45.269334-45.248L748.394667 341.333333H672c-121.685333 0-220.714667 97.024-223.914667 217.941334L448 565.333333v85.333334h-64v-85.333334C384 406.272 512.938667 277.333333 672 277.333333h99.861333l-85.312-85.333333 45.248-45.248z" p-id="2684" fill="var(--first-text-color)"></path></svg>
      </i></a>
    
    <a href="javascript:window.scrollTo({top:0,behavior:'smooth'});" class="click-btn">
      <i id="i-up"></i>
    </a>
</div>

<!-- SCRIPTS -->






<script>
    document.getElementById("btn-dropdown").addEventListener('click', () => {
      toggleClass("#dropdown-menus","display-inline");
    });
    console.log('\n' + ' %c Powered by Hexo Theme Miracle ' + ' %c https://github.com/hifun-team/hexo-theme-miracle ' + '\n' + '\n', 'color: #fff; background: #4F9BFA; padding:5px 0;', 'background: #FFF; padding:5px 0;');

    

    
  /* 小彩蛋: 饮茶先啦 */
  setTimeout(() => {
    var time = new Date();
    if (time.getHours() == 15) {
      let comment = document.createComment(' 三点几嚟！饮茶先啦！ ');
      document.body.insertBefore(comment, document.getElementsByTagName('header')[0]);
    }
  },1);
    
</script>


<script>
    var postImg = document.querySelectorAll("article[class=page] img");
    for (let imgi = 0; imgi < postImg.length; imgi++) {
        postImg[imgi].onclick = () => {
            let zoomImg = document.createElement("div");
            zoomImg.id = "zoomImg";
            zoomImg.innerHTML = `<div id="zoom-picture"></div>
    <div class="poptrox-overlay"
        style="position: fixed; left: 0px; top: 0px; z-index: 20000; width: 100%; height: 100%; text-align: center; cursor: zoom-out; opacity: 1;">
        <div style="display:inline-block;height:100%;vertical-align:middle;"></div>
        <div
            style="position:absolute;left:0;top:0;width:100%;height:100%;background:#000000;opacity:0;filter:alpha(opacity=0);">
        </div>
        <div class="poptrox-popup"
            style="display: inline-block; vertical-align: middle; position: relative; z-index: 1; cursor: zoom-out; min-width: 10px; min-height: 10px; width: auto; height: auto;">
            <div class="loader" style="display: none;"></div>
            <div class="pic" style="text-indent: 0px;"><img
                    src="${ postImg[imgi].srcset || postImg[imgi].src }" alt="Loading..."
                    style="vertical-align: bottom; max-width: 85vw; max-height: 85vh;"></div>
        </div>
    </div>`;
            document.body.appendChild(zoomImg);
                document.querySelector("#zoomImg").onclick = () => {
                    document.querySelector("#zoomImg").remove();
                }
        }
    }
    
</script>




    <script>
        query("#toc-btn")[0].onclick = () => {
            if (query(".post-toc")[0].innerHTML) {
                toggleClass(".post-toc", "display-inline");
            }
        }

        if (!query(".post-toc")[0].innerHTML) {
            addClass("#toc-btn","display-none");
        }
    </script>



    <script>
        query("#share-btn")[0].onclick = async () => {
            let url = `${location.protocol}//${location.hostname}${location.port ? ":"+location.port:location.port}${location.pathname}#read=${sessionStorage.getItem(location.pathname+"_read_y") || ""}`;
            try {
                await navigator.clipboard.writeText(url);
                prompt_core("分享链接已经复制至剪贴板", 4800, true);
            } catch(e) {
                prompt_core("分享链接复制失败，请手动复制<br/>"+url, 4800, false);
            }
        }
    </script>





    <script>
        setTimeout(() => {
            loadScriptFile({
                url: "//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",
                loadType: "async"
            });
        },0);
    </script>



    <script>
        const getScrollPosition = (el = window) => ({
            x: el.pageXOffset !== undefined ? el.pageXOffset : el.scrollLeft,
            y: el.pageYOffset !== undefined ? el.pageYOffset : el.scrollTop
        });
        // 此处的 750 是「页面元素的最大宽度」
        var wx = document.getElementsByClassName("article-m")[0].clientWidth;
        var wy = document.getElementsByClassName("article-m")[0].clientHeight;
        function windowScroll() {
            // 反复修改 确保页面尺寸不改变
            wx = document.getElementsByClassName("article-m")[0].clientWidth;
            wy = document.getElementsByClassName("article-m")[0].clientHeight;
            let y = Math.round(getScrollPosition().y);
            // console.log(y);
            // 组合字符串，同时记录页面坐标，页面宽度和高度
            let p = `${y}:${wx}:${wy}`;
            // 写入到 sessionStorage 中
            sessionStorage.setItem(location.pathname + "_read_y", p);
        }
        // URL 中是否包含传递的坐标信息
        setTimeout(() => {
            if (location.hash.split("#read=").length > 1) {
                prompt_core("已有阅读进度，正在跳转", 4800, true);
                // 分离字符串
                let read_y = location.hash.split("#read=")[1];
                read_y = read_y.split(":");
                // 组合乘积，顺滑移动至坐标
                window.scrollTo({top: Math.round(Number(read_y[0]) * Number(read_y[1] * Number(read_y[2] / wx / wy))), behavior: "smooth"});
            } else {
                // 从 sessionStorage 中获取
                let read_y = sessionStorage.getItem(location.pathname + "_read_y") || "0:0:0";
                read_y = read_y.split(":");
                if (read_y[0] != "0") prompt_core("已有阅读进度，正在跳转", 4800, true);
                window.scrollTo({top: Math.round(Number(read_y[0]) * Number(read_y[1] * Number(read_y[2] / wx / wy))), behavior: "smooth"});
            }
        }, 500);
        window.onscroll = windowScroll;
    </script>





        </div>
        <div id="css-loading">
            <h3 class="text-center">加载中...</h3>
        </div>
        
    </body>
</html>
